

Before I get to today's problem, I'd just like to give a warm welcome to our two new moderators, [nooodl](http://www.reddit.com/user/nooodl) and [Steve132](http://www.reddit.com/user/Steve132)! We decided to appoint two new moderators instead of just one, because rya11111 has decided to a bit of a break for a while.

I'd like to thank everyone who applied to be moderators, there were lots of excellent submissions, we will keep you in mind for the next time. Both nooodl and Steve132 have contributed some excellent problems and solutions, and I have no doubt that they will be excellent moderators.

Now, to today's problem! Good luck!

* * *

In 1987, mathematician John Conway invented one of the most curious programming languages ever, which he dubbed [FRACTRAN](http://en.wikipedia.org/wiki/Fractran).

A FRACTRAN program is simply a series of fractions, nothing more, nothing less. As input, the program takes a single integer. The program runs like this:

1.

The integer is checked against each fraction in order. If the result of multiplying that integer with the fraction is another integer, you start over with the product generated by multiplying with that fraction.

2.

If none of the fractions multiplied by the input integer results in another integer, the program finishes and returns the integer as the result.

Conway was able to show that despite the simplicity of this "programming language", it is in fact Turing-complete, meaning that any computation you can do in any other language, you can do in FRACTRAN.

The [wikipedia article for FRACTRAN](http://en.wikipedia.org/wiki/Fractran) explains very well how this works and how to write a program in FRACTRAN.

Your task is to first of all write a FRACTRAN interpreter that is able to run FRACTRAN programs (and remember that the numbers can very easily get very large, so 64-bit integers is not going to be enough, you need big numbers) and then to write a program in FRACTRAN. Here are a few suggestions of programs you could write, roughly ordered from least difficult to most difficult:

1.

Implement the min(a,b) function. So for input 2a \* 3b the code returns 5min(a,b) where min(a,b) is the smallest number of a and b. Example: input 5832 should output 125 ( 23 \* 36 -> 53 )

2.

Implement the max(a,b) function. So for input 2a \* 3b the code returns 5max(a,b) where max(a,b) is the largest number of a and b. Example: input 5832 should output 15625 ( 23 \* 36 -> 56 )

3.

Write a program that takes an input a that is divisible by 3 and divides it by 3. So for input 2a it returns 3a/3 . Example: input 2097152 should output 2187 ( 221 -> 37 ). Note: this can be done in a single fraction.

4.

Write a program that for an input n, returns the sum of all integers less than n. So if the input is 25, it should output 31+2+3+4 = 310. Example: input 32 should output 59049 ( 25 -> 310 )

5.

Write a program that generates the nth fibonacci number. So for input 2n it should output 3f(n) where f(n) is the nth fibonacci number. Example: input 128 should output 1594323 ( 27 -> 313 ).

